// SLURM executor configuration
executor {
    name = 'slurm'
    queueSize = 100
    submitRateLimit = '10 sec'
}

// Process configuration for SLURM
process {
    executor = 'slurm'

    withLabel: 'standard' {
        cpus = 1
        memory = '64GB'
        clusterOptions = '--nodes=1 --ntasks=1 --partition=20'
    }
    
    withLabel: 'high_memory' {
        cpus = 1
        memory = '128GB'
        clusterOptions = '--nodes=1 --ntasks=1 --partition=20'
    }
}    

// Work directory
workDir = '/lab/BaRC_projects/labs/Jain_Lab/Kelsey_DMSMapSeq_Apr_2021/codenf3/work'

// Capture exit codes from upstream processes when piping
process.shell = ['/bin/bash']

// Capture Nextflow log files
timeline {
    enabled = true
    overwrite = true
    file = "${params.outdir}/pipeline_info/execution_timeline.html"
}
report {
    enabled = true
    overwrite = true    
    file = "${params.outdir}/pipeline_info/execution_report.html"
}
trace {
    enabled = true
    overwrite = true    
    file = "${params.outdir}/pipeline_info/execution_trace.txt"
}
dag {
    enabled = true
    overwrite = true    
    file = "${params.outdir}/pipeline_info/pipeline_dag.png"
}

// Additional recommended settings
monitor {
    enabled = true
}

// Manifest
manifest {
    name = 'DMS-MaPseq Pipeline'
    author = 'Troy Whitfield'
    description = 'Genome-wide analysis of DMS-MaPseq data'
    version = '1.0.0'
    nextflowVersion = '>=21.04.0'
}
